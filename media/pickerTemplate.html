<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <!-- CSP nonce replaced at runtime -->
    <title>SF Deployer Picker</title>
    <style>
      body {
        font-family: sans-serif;
        display: flex;
        flex-direction: column;
        gap: 10px;
        padding: 10px;
        height: 100vh;
        box-sizing: border-box;
      }
      .vscode-disabled-foreground {
        color: var(--vscode-disabledForeground);
      }
      .vscode-foreground {
        color: var(--vscode-foreground);
      }
      .vscode-textlink-foreground {
        color: var(--vscode-textLink-foreground);
      }
      .controls {
        display: flex;
        gap: 16px;
        align-items: center;
        flex-wrap: wrap;
      }
      .controls label {
        margin-right: 4px;
      }
      .flags {
        display: flex;
        gap: 12px;
        align-items: center;
        flex-wrap: wrap;
      }
      .main {
        display: flex;
        gap: 20px;
        flex: 1 1 auto;
        overflow: hidden;
      }
      #treePane {
        flex: 2;
        overflow: auto;
        border-right: 1px solid #ddd;
        padding-right: 10px;
      }
      #selectedPane {
        flex: 1;
        overflow: auto;
        padding-left: 10px;
      }
      #manifestPane {
        flex: 1;
        overflow: auto;
        padding-left: 10px;
      }
      #manifestPre {
        white-space: pre-wrap;
        font-family: monospace;
        font-size: 12px;
      }
      ul {
        list-style-type: none;
        padding-left: 1em;
      }
      li {
        margin: 2px 0;
      }
      .codicon {
        padding-right: 4px;
      }
    </style>
  </head>
  <body>
    <h3>SF Deployer</h3>
    <div
      id="cmdPreview"
      style="font-family: monospace; margin-bottom: 6px; color: #555"
    >
      sf project deploy start --manifest &lt;package.xml&gt;
    </div>
    <div>
      <input
        id="filterInput"
        type="text"
        placeholder="Filter by nameâ€¦"
        maxlength="200"
        style="width: 100%; padding: 4px; box-sizing: border-box"
      />
    </div>
    <div class="controls" style="display: flex; gap: 20px">
      <!-- Main Picker Controls -->
      <div
        style="
          flex: 2;
          display: flex;
          gap: 16px;
          align-items: center;
          flex-wrap: wrap;
          border-right: 1px solid #555;
          padding-right: 20px;
        "
      >
        <div
          class="flags"
          style="display: flex; gap: 12px; align-items: center; flex-wrap: wrap"
        >
          <label><input type="checkbox" id="dryRun" /> Dry-run</label>
          <label>Tests:</label>
          <label
            ><input type="radio" name="testLevel" value="all" /> Run All</label
          >
          <label
            ><input type="radio" name="testLevel" value="none" checked /> No
            Tests</label
          >
          <label
            ><input type="radio" name="testLevel" value="specified" /> Run
            Specified</label
          >
        </div>
        <button id="deployBtn">Deploy</button>
        <button id="clearBtn">Clear All</button>
      </div>

      <!-- Manifest Controls -->
      <div
        class="manifest-controls"
        style="
          flex: 1;
          display: flex;
          align-items: center;
          gap: 8px;
          padding-left: 20px;
        "
      >
        <input
          id="manifestName"
          type="text"
          placeholder="Manifest name..."
          style="
            width: 120px;
            padding: 4px;
            border: 1px solid #555;
            background: #2d2d30;
            color: #cccccc;
            border-radius: 2px;
            font-size: 12px;
          "
          maxlength="50"
        />
        <button
          id="saveManifestBtn"
          style="
            padding: 4px 8px;
            background: #007acc;
            color: white;
            border: none;
            border-radius: 2px;
            cursor: pointer;
            font-size: 12px;
          "
        >
          Save
        </button>
        <select
          id="manifestDropdown"
          style="
            width: 120px;
            padding: 4px;
            border: 1px solid #555;
            background: #2d2d30;
            color: #cccccc;
            border-radius: 2px;
            font-size: 12px;
          "
        >
          <option value="">-- Select manifest --</option>
        </select>
        <button
          id="loadManifestBtn"
          style="
            padding: 4px 8px;
            background: #28a745;
            color: white;
            border: none;
            border-radius: 2px;
            cursor: pointer;
            font-size: 12px;
          "
        >
          Load
        </button>
      </div>
    </div>

    <div class="main">
      <div id="treePane">
        <p id="loading">Loading file tree...</p>
        <div id="tree"></div>
      </div>
      <ul id="selList" style="display: none"></ul>
      <div id="manifestPane">
        <h4>Manifest Preview</h4>
        <pre
          id="manifestPre"
          style="
            overflow: auto;
            white-space: pre-wrap;
            font-family: monospace;
            font-size: 12px;
            height: 100%;
          "
        ></pre>
      </div>
    </div>

    <script nonce="__NONCE__" src="pickerScript.js"></script>
  </body>
</html>
